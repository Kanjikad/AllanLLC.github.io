<!DOCTYPE html>
<html lang="pt-br" data-theme="dark">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Fetishdle</title>
    <style>
        /* --- CORES E VARI√ÅVEIS (CLARO E ESCURO) --- */
        :root {
            --correct: #538d4e;
            --present: #b59f3b;
            --absent: #3a3a3c;
            --default-bg: #121213;
            --text-color: #ffffff;
            --border-color: #3a3a3c;
            --key-bg: #818384;
            --hint-bg: #2c2c2e;
            --hint-text: #4dbce9;
            --overlay-bg: rgba(0, 0, 0, 0.85);
        }

        /* Defini√ß√µes do Modo Claro */
        [data-theme="light"] {
            --correct: #6aaa64;
            --present: #c9b458;
            --absent: #787c7e;
            --default-bg: #ffffff;
            --text-color: #000000;
            --border-color: #d3d6da;
            --key-bg: #d3d6da;
            --hint-bg: #f0f0f0;
            --hint-text: #0077cc;
            --overlay-bg: rgba(255, 255, 255, 0.9);
        }

        * { box-sizing: border-box; }

        body {
            background-color: var(--default-bg);
            color: var(--text-color);
            font-family: 'Helvetica Neue', Arial, sans-serif;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: space-between; /* Espalha conte√∫do */
            margin: 0;
            height: 100vh; /* Altura total da viewport */
            overflow: hidden; /* Evita scroll no mobile */
            transition: background-color 0.3s, color 0.3s;
        }

        /* --- CABE√áALHO --- */
        header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            width: 100%;
            max-width: 600px;
            padding: 10px 20px;
            border-bottom: 1px solid var(--border-color);
        }

        h1 { margin: 0; font-size: 24px; letter-spacing: 2px; }

        .theme-btn {
            background: none;
            border: none;
            cursor: pointer;
            font-size: 24px;
            color: var(--text-color);
        }

        /* --- √ÅREA CENTRAL (DICA + TABULEIRO) --- */
        #game-container {
            flex-grow: 1;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            width: 100%;
            overflow-y: auto;
            padding: 10px;
        }

        #hint-container {
            background-color: var(--hint-bg);
            padding: 8px 15px;
            border-radius: 8px;
            margin-bottom: 15px;
            text-align: center;
            font-size: 14px;
            max-width: 90%;
            border: 1px solid var(--border-color);
        }

        #hint-text { font-weight: bold; color: var(--hint-text); }

        #message-area {
            height: 20px;
            margin-bottom: 10px;
            font-weight: bold;
            font-size: 14px;
            text-align: center;
        }

        /* --- TABULEIRO --- */
        #game-board {
            display: grid;
            grid-gap: 5px;
            margin-bottom: 10px;
            max-width: 100%;
        }

        .tile {
            width: 45px;
            height: 45px;
            border: 2px solid var(--border-color);
            display: flex;
            justify-content: center;
            align-items: center;
            font-size: 20px;
            font-weight: bold;
            text-transform: uppercase;
            user-select: none;
            transition: transform 0.25s, border-color 0.25s, background-color 0.25s;
        }

        /* Responsividade do Tabuleiro */
        .tile.small-text { font-size: 14px; width: 32px; height: 32px; }
        .tile.tiny-text { font-size: 10px; width: 22px; height: 22px; }

        /* --- ANIMA√á√ïES --- */
        /* Pop ao digitar */
        .pop { animation: pop 0.1s; }
        @keyframes pop { 50% { transform: scale(1.1); } }

        /* Flip ao revelar */
        .flip {
            transform: rotateX(90deg); /* Come√ßa a girar */
            transition: transform 0.25s ease-in;
        }

        /* Shake ao errar */
        .shake { animation: shake 0.5s; }
        @keyframes shake {
            0%, 100% { transform: translateX(0); }
            10%, 30%, 50%, 70%, 90% { transform: translateX(-4px); }
            20%, 40%, 60%, 80% { transform: translateX(4px); }
        }

        /* Estados das Cores (CSS Classes) */
        .correct { background-color: var(--correct); border-color: var(--correct); color: white; }
        .present { background-color: var(--present); border-color: var(--present); color: white; }
        .absent { background-color: var(--absent); border-color: var(--absent); color: white; }

        /* --- TECLADO VIRTUAL --- */
        #keyboard-container {
            width: 100%;
            max-width: 600px;
            padding: 10px 5px;
            background-color: var(--default-bg);
        }

        .keyboard-row {
            display: flex;
            justify-content: center;
            margin-bottom: 6px;
            touch-action: manipulation;
        }

        .key {
            font-family: inherit;
            font-weight: bold;
            border: 0;
            padding: 0;
            margin: 0 3px;
            height: 50px;
            border-radius: 4px;
            cursor: pointer;
            user-select: none;
            background-color: var(--key-bg);
            color: var(--text-color);
            flex: 1;
            display: flex;
            justify-content: center;
            align-items: center;
            text-transform: uppercase;
            font-size: 14px;
            transition: background-color 0.3s;
        }

        .key-wide { flex: 1.5; font-size: 12px; }
        
        /* Cores do Teclado quando reveladas */
        .key.correct { background-color: var(--correct); border-color: var(--correct); }
        .key.present { background-color: var(--present); border-color: var(--present); }
        .key.absent { background-color: var(--absent); border-color: var(--absent); }

        /* --- MODAL DE RESULTADO --- */
        #result-modal {
            position: fixed;
            top: 0; left: 0; width: 100%; height: 100%;
            background: var(--overlay-bg);
            display: none;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            z-index: 100;
        }
        
        #result-content {
            text-align: center;
            padding: 20px;
        }

        button.restart-btn {
            margin-top: 20px;
            padding: 15px 30px;
            background-color: var(--correct);
            color: white;
            border: none;
            font-weight: bold;
            font-size: 18px;
            cursor: pointer;
            border-radius: 50px;
        }
    </style>
</head>
<body>

    <header>
        <div></div> <h1>FETISHDLE</h1>
        <button class="theme-btn" onclick="toggleTheme()" id="theme-icon">‚òÄÔ∏è</button>
    </header>

    <div id="game-container">
        <div id="message-area"></div>
        
        <div id="game-board"></div>

        <div id="hint-container">
            DICA: <span id="hint-text">...</span>
        </div>
    </div>

    <div id="keyboard-container">
        </div>

    <div id="result-modal">
        <div id="result-content">
            <h2 id="modal-title">FIM DE JOGO</h2>
            <p id="modal-msg"></p>
            <button class="restart-btn" onclick="initGame()">JOGAR NOVAMENTE</button>
        </div>
    </div>

    <script>
        /* --- DADOS --- */
        const wordDatabase = [
            {"word": "MASOQUISMO", "hint": "Fetiche mais buscado no Brasil: excita√ß√£o ao receber dor ou humilha√ß√£o"},
            {"word": "VOYEURISMO", "hint": "Excita√ß√£o sexual ao observar outras pessoas sem que elas saibam"},
            {"word": "SADISMO", "hint": "Prazer em causar dor ou humilha√ß√£o no parceiro"},
            {"word": "BONDAGE", "hint": "Uso de amarras, cordas ou algemas para imobilizar o parceiro"},
            {"word": "FACESITTING", "hint": "Pr√°tica de sentar no rosto do parceiro para prazer oral"},
            {"word": "FETICHISMO", "hint": "Atra√ß√£o sexual intensa por p√©s"},
            {"word": "DEGRADACAO", "hint": "Excita√ß√£o ao ser humilhado ou chamado por nomes pejorativos"},
            {"word": "CHASTITY", "hint": "Uso de cintos ou gaiolas para impedir ere√ß√£o ou orgasmo"},
            {"word": "EDGING", "hint": "Levar ao limite do orgasmo e parar repetidamente"},
            {"word": "EXIBICIONISMO", "hint": "Excita√ß√£o ao se mostrar nu ou em atos sexuais em p√∫blico"},
            {"word": "STRAPON", "hint": "Uso de cinta com consolo para penetra√ß√£o (pegation)"},
            {"word": "FISTING", "hint": "Inser√ß√£o completa da m√£o na vagina ou no √¢nus"},
            {"word": "SOUNDING", "hint": "Inser√ß√£o de hastes met√°licas na uretra"},
            {"word": "OMORASHI", "hint": "Fetiche japon√™s por segurar xixi ou se molhar de prop√≥sito"},
            {"word": "DIRTYTALK", "hint": "Falar sacanagem ou palavr√µes durante o sexo"},
            {"word": "CUCKOLD", "hint": "Excita√ß√£o ao ver a parceira com outro homem"},
            {"word": "JOI", "hint": "V√≠deos ou √°udios em que a pessoa manda voc√™ se masturbar"},
            {"word": "CORSELET", "hint": "Fetiche por espartilhos que apertam a cintura"},
            {"word": "PETPLAY", "hint": "Fingir ser animal de estima√ß√£o (cachorrinho, gatinho etc.)"},
            {"word": "WAXPLAY", "hint": "Pingar cera quente de vela no corpo do parceiro"}
        ];

        /* --- ESTADO DO JOGO --- */
        let currentWordObj = {};
        let currentWord = "";
        let currentRow = 0;
        let currentTile = 0;
        let isGameOver = false;
        let isAnimating = false; // Bloqueia input durante anima√ß√£o
        const maxGuesses = 6;

        /* --- ELEMENTOS --- */
        const board = document.getElementById('game-board');
        const messageArea = document.getElementById('message-area');
        const hintText = document.getElementById('hint-text');
        const resultModal = document.getElementById('result-modal');
        const modalTitle = document.getElementById('modal-title');
        const modalMsg = document.getElementById('modal-msg');
        const keyboardContainer = document.getElementById('keyboard-container');
        const themeIcon = document.getElementById('theme-icon');

        /* --- INICIALIZA√á√ÉO --- */
        function initGame() {
            currentRow = 0;
            currentTile = 0;
            isGameOver = false;
            isAnimating = false;
            messageArea.textContent = "";
            resultModal.style.display = "none";
            board.innerHTML = '';
            
            // Escolhe palavra
            const randomIndex = Math.floor(Math.random() * wordDatabase.length);
            currentWordObj = wordDatabase[randomIndex];
            currentWord = currentWordObj.word.toUpperCase();
            
            hintText.textContent = currentWordObj.hint;

            // Configura Grid
            const wordLength = currentWord.length;
            board.style.gridTemplateColumns = `repeat(${wordLength}, 1fr)`;

            // Ajusta tamanho da letra para Mobile
            let tileClass = "tile";
            if (wordLength > 8) tileClass += " small-text";
            if (wordLength > 12) tileClass += " tiny-text";

            for (let i = 0; i < maxGuesses * wordLength; i++) {
                const tile = document.createElement('div');
                tile.className = tileClass;
                tile.setAttribute('id', `tile-${i}`);
                board.appendChild(tile);
            }

            // Reseta teclado virtual
            createKeyboard();
        }

        /* --- TEMA --- */
        function toggleTheme() {
            const html = document.documentElement;
            const current = html.getAttribute('data-theme');
            if (current === 'dark') {
                html.setAttribute('data-theme', 'light');
                themeIcon.textContent = 'üåô';
            } else {
                html.setAttribute('data-theme', 'dark');
                themeIcon.textContent = '‚òÄÔ∏è';
            }
        }

        /* --- TECLADO VIRTUAL --- */
        function createKeyboard() {
            keyboardContainer.innerHTML = '';
            const layout = [
                "QWERTYUIOP",
                "ASDFGHJKL√á",
                "ZXCVBNM"
            ];

            layout.forEach((rowStr, index) => {
                const rowDiv = document.createElement('div');
                rowDiv.className = 'keyboard-row';
                
                // Adiciona Enter no come√ßo da √∫ltima linha
                if (index === 2) {
                    const enterKey = createKeyElement("ENTER", "ENTER", true);
                    rowDiv.appendChild(enterKey);
                }

                rowStr.split('').forEach(char => {
                    const keyBtn = createKeyElement(char, char, false);
                    rowDiv.appendChild(keyBtn);
                });

                // Adiciona Backspace no fim da √∫ltima linha
                if (index === 2) {
                    const backKey = createKeyElement("‚å´", "BACKSPACE", true);
                    rowDiv.appendChild(backKey);
                }

                keyboardContainer.appendChild(rowDiv);
            });
        }

        function createKeyElement(display, value, isWide) {
            const btn = document.createElement('button');
            btn.textContent = display;
            btn.setAttribute('data-key', value);
            btn.className = isWide ? 'key key-wide' : 'key';
            
            btn.onclick = () => {
                if (value === 'ENTER') handleInput('ENTER');
                else if (value === 'BACKSPACE') handleInput('BACKSPACE');
                else handleInput(value);
            };
            return btn;
        }

        /* --- INPUT --- */
        document.addEventListener('keydown', (e) => {
            const key = e.key.toUpperCase();
            if (key === 'ENTER' || key === 'BACKSPACE') handleInput(key);
            else if (/^[A-Z√á]$/i.test(key)) handleInput(key);
        });

        function handleInput(key) {
            if (isGameOver || isAnimating) return;

            if (key === 'ENTER') {
                checkRow();
            } else if (key === 'BACKSPACE') {
                deleteLetter();
            } else {
                addLetter(key);
            }
        }

        function addLetter(letter) {
            const wordLength = currentWord.length;
            if (currentTile < (currentRow + 1) * wordLength) {
                const tile = document.getElementById(`tile-${currentTile}`);
                tile.textContent = letter;
                tile.classList.add('pop');
                // Remove animation class after plays
                setTimeout(() => tile.classList.remove('pop'), 100);
                
                // Borda de foco visual
                tile.style.borderColor = "var(--text-color)";
                currentTile++;
            }
        }

        function deleteLetter() {
            const wordLength = currentWord.length;
            if (currentTile > currentRow * wordLength) {
                currentTile--;
                const tile = document.getElementById(`tile-${currentTile}`);
                tile.textContent = '';
                tile.style.borderColor = "var(--border-color)";
            }
        }

        /* --- L√ìGICA DE JOGO E ANIMA√á√ÉO --- */
        function checkRow() {
            const wordLength = currentWord.length;
            
            // Verifica tamanho
            if (currentTile !== (currentRow + 1) * wordLength) {
                showMessage("Poucas letras!");
                shakeRow();
                return;
            }

            // Inicia valida√ß√£o
            isAnimating = true; // Bloqueia input

            let guess = "";
            const startTileId = currentRow * wordLength;
            
            // Constr√≥i a palavra do usu√°rio
            for (let i = 0; i < wordLength; i++) {
                guess += document.getElementById(`tile-${startTileId + i}`).textContent;
            }

            // L√≥gica de Cores
            const guessArray = guess.split('');
            const wordArray = currentWord.split('');
            const tileStatus = new Array(wordLength).fill('absent');
            
            // 1. Marca Corretos (Verde)
            for (let i = 0; i < wordLength; i++) {
                if (guessArray[i] === wordArray[i]) {
                    tileStatus[i] = 'correct';
                    wordArray[i] = null; 
                    guessArray[i] = null; 
                }
            }

            // 2. Marca Presentes (Amarelo)
            for (let i = 0; i < wordLength; i++) {
                if (guessArray[i] && wordArray.includes(guessArray[i])) {
                    tileStatus[i] = 'present';
                    wordArray[wordArray.indexOf(guessArray[i])] = null; 
                }
            }

            // 3. Aplica Anima√ß√£o FLIP Sequencial
            for (let i = 0; i < wordLength; i++) {
                const tile = document.getElementById(`tile-${startTileId + i}`);
                const letter = tile.textContent;
                const status = tileStatus[i];

                setTimeout(() => {
                    // Adiciona classe que roda 90deg
                    tile.classList.add('flip');
                    tile.style.backgroundColor = getComputedStyle(document.documentElement).getPropertyValue('--default-bg');
                    tile.style.borderColor = getComputedStyle(document.documentElement).getPropertyValue('--default-bg');
                }, i * 250); // Delay cascata

                // No meio da anima√ß√£o (quando carta est√° de lado), troca a cor
                setTimeout(() => {
                    tile.classList.add(status);
                    tile.classList.remove('flip'); // Volta a posi√ß√£o normal com a nova cor
                    tile.style.transform = ''; // Limpa transform
                    
                    // Atualiza Teclado Virtual
                    updateKeyboardColor(letter, status);

                    // Se for a √∫ltima letra, verifica fim de jogo
                    if (i === wordLength - 1) {
                        endTurnLogic(guess, wordLength);
                    }
                }, (i * 250) + 250);
            }
        }

        function updateKeyboardColor(letter, status) {
            const keyBtn = document.querySelector(`button[data-key="${letter}"]`);
            if (!keyBtn) return;

            // Prioridade de Cores: Correct > Present > Absent
            const currentClass = keyBtn.classList;
            if (status === 'correct') {
                keyBtn.classList.remove('present', 'absent');
                keyBtn.classList.add('correct');
            } else if (status === 'present' && !currentClass.contains('correct')) {
                keyBtn.classList.remove('absent');
                keyBtn.classList.add('present');
            } else if (status === 'absent' && !currentClass.contains('correct') && !currentClass.contains('present')) {
                keyBtn.classList.add('absent');
            }
        }

        function endTurnLogic(guess, wordLength) {
            isAnimating = false;

            if (guess === currentWord) {
                setTimeout(() => showResult("PARAB√âNS!", "Voc√™ acertou a palavra!"), 500);
                isGameOver = true;
            } else {
                if (currentRow >= maxGuesses - 1) {
                    setTimeout(() => showResult("FIM DE JOGO", `A palavra era: ${currentWord}`), 500);
                    isGameOver = true;
                } else {
                    currentRow++;
                }
            }
        }

        function shakeRow() {
            const wordLength = currentWord.length;
            const startTileId = currentRow * wordLength;
            for (let i = 0; i < wordLength; i++) {
                const tile = document.getElementById(`tile-${startTileId + i}`);
                tile.classList.add('shake');
                setTimeout(() => tile.classList.remove('shake'), 500);
            }
        }

        function showMessage(msg) {
            messageArea.textContent = msg;
            setTimeout(() => {
                if (!isGameOver) messageArea.textContent = "";
            }, 2000);
        }

        function showResult(title, text) {
            modalTitle.textContent = title;
            modalMsg.textContent = text;
            resultModal.style.display = 'flex';
        }

        // Inicia
        initGame();

    </script>
</body>
</html>
